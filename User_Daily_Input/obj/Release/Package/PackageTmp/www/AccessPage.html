<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Table with Filters</title>

    <!--Toastr CSS-->



    <link rel="stylesheet" type="text/css" href="../semantic/dist/semantic.min.css">
    <link rel="stylesheet" type="text/css" href="../fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" type="text/css" href="../fontawesome/css/solid.min.css">

    <link rel="stylesheet" type="text/css" href="../fontawesome/css/regular.min.css">

    <link href="../jquery-ui/jquery-ui.css" rel="stylesheet" />
    <link href="../scripts/datatables.min.css" rel="stylesheet" />
    <link href="../datatable/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="../scripts/buttons.dataTables.min.css" rel="stylesheet" />


    <script type="text/javascript" src="../scripts/jquery-3.6.0.js"></script>
    <script src="../jquery-ui/jquery-ui.js"></script>

    <script type="text/javascript" src="../fontawesome/js/fontawesome.min.js"></script>
    <!--<link href="../jquery-ui/jquery-ui.css" rel="stylesheet" />-->
    <!-- <link href='https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/ui-lightness/jquery-ui.css'
           rel='stylesheet'>-->
    <!--<link href="../Manday_CDN/jquery-ui.css" rel="stylesheet" />-->

    <script src="../scripts/datatables.min.js"></script>



    <script src="../scripts/jquery.dataTables.min.js"></script>
    <script src="../scripts/dataTables.buttons.min.js"></script>

    <script src="../scripts/buttons.html5.min.js"></script>
    <script src="../scripts/jszip.min.js"></script>

    <script src="../scripts/moment.js"></script>

    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">-->
    <link href="../Manday_CDN/toastr.min.css" rel="stylesheet" />

    <!--Toastr JS-->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>-->
    <script src="../Manday_CDN/toastr.min.js"></script>
    <script type="text/javascript" src="../semantic/dist/semantic.min.js"></script>


    <style>
        .radio-field {
            position: relative;
            top: 0.3in; /* Adjust as needed */
        }

        .submit-field {
            position: relative;
            top: 0.2in; /* Adjust as needed */
        }

        body, html {
            font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
            /*background-color:honeydew;*/
        }

        fieldset {
            width: 500px;
            align-content: center;
            border: 2px solid black;
        }

        .demo-container {
            overflow-x: auto; /* Add horizontal scrollbar when content overflows */
            max-width: 100%; /* Limit container width to the viewport width */
            margin: 0 auto; /* Center the container horizontally */
        }

        .dataTables_wrapper {
            overflow-x: auto; /* Add horizontal scrollbar when content overflows */
        }

        .lock {
            color: white;
            background-color: red;
        }

        .unlock {
            color: white;
            background-color: green;
        }

        #cover-spin {
            position: fixed;
            width: 100%;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            background-color: rgba(255,255,255,0.7);
            z-index: 9999;
            display: none;
        }

        @-webkit-keyframes spin {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        #cover-spin::after {
            content: '';
            display: block;
            position: absolute;
            left: 48%;
            top: 40%;
            width: 40px;
            height: 40px;
            border-style: solid;
            border-color: black;
            border-top-color: transparent;
            border-width: 4px;
            border-radius: 50%;
            -webkit-animation: spin .8s linear infinite;
            animation: spin .8s linear infinite;
        }
    </style>
</head>

<body>

    <div class="ui segment">
        <div class="ui teal top attached inverted tabular menu" style="width: 30%; height: 40px; font-family: Cambria, Cochin, Georgia, Times, Times New Roman, serif">
            <!--<div class="ui menu top" style="width:30%; font-family:Cambria, Cochin, Georgia, Times, Times New Roman, serif">-->
            <!--<a class="item" data-tab="menu" style="width:34%"> <i class="large blue list icon"></i> Menu </a>-->
            <a class="item" data-tab="search_report" style="width:50%"> <i class="big yellow search icon"></i> Search </a>
            <a class="active item" data-tab="userLock" style="width:50%"> <i class="large pink check key icon"></i> Lock/Unlock </a>
        </div>

        <div class="ui tab" data-tab="userLock">
            <div class="ui column grid">
                <div class="column">
                    <div class="ui stacked aligned segment">
                        <div class="ui red ribbon label">Lock/UnLock</div>

                        <div class="ui medium form">
                            <div class="five fields">

                                <div class="three wide field">
                                    <label>Region</label>
                                    <select id="region" class="form-control input">
                                        <option value="">Select Region</option>
                                        <option value="ALL">ALL</option>
                                        <option value="APC">APC</option>
                                        <option value="APH">APH</option>
                                        <option value="APE">APE</option>
                                        <option value="GROUP">GROUP</option>
                                    </select>

                                </div>
                                <div class="three wide field">
                                    <label>Department</label>
                                    <select id="department" class="form-control input">
                                        <option value="">Select Department</option>
                                        <!--<option value="APC">APC</option>
                                    <option value="APH">APH</option>
                                    <option value="APE">APE</option>-->
                                    </select>
                                </div>

                                <div class="three wide field">
                                    <label>Emp No</label>
                                    <select id="employee" class="form-control input">
                                        <option value="">Select Emp NO</option>
                                        <!--<option value="APC">APC</option>
                                    <option value="APH">APH</option>
                                    <option value="APE">APE</option>-->
                                    </select>

                                </div>
                                <div class="three wide field">
                                    <label>Category</label>
                                    <select id="Category" class="input">
                                        <option value="" selected>Select Category</option>
                                        <option value="ALL">ALL</option>
                                        <option value="项目Project">项目Project</option>
                                        <option value="运维-日常Maintenance-Daily">运维-日常Maintenance-Daily</option>
                                        <option value="运维-需求Maintenance-Req.">运维-需求Maintenance-Req.</option>
                                        <option value="行政管理Administration">行政管理Administration</option>
                                        <option value="培训学习Training/Study">培训学习 Training/Study</option>
                                        <option value="休假Leave">休假 Leave</option>
                                        <option value="空闲Idle">空闲 Idle</option>

                                    </select>
                                </div>
                                <div class="three wide field" id="requirement1">
                                    <label>Project Name</label>
                                    <select id="project_name" class="form-control" autocomplete="off">
                                        <option value="" selected>Select Project</option>
                                    </select>
                                </div>
                            </div>
                            <div class="five fields">


                                <div class="three wide field">
                                    <label>From Date</label>
                                    <input type="text" id="fromDate" class="form-control" autocomplete="off">
                                </div>
                                <div class="three wide field">
                                    <label>To Date</label>
                                    <input type="text" id="toDate" class="form-control" autocomplete="off">
                                </div>

                                <div class="one wide field radio-field">
                                    <div class="ui radio checkbox">
                                        <input type="radio" name="frequency" value="Lock">
                                        <label>Lock</label>
                                    </div>
                                </div>
                                <div class="one wide field radio-field">
                                    <div class="ui radio checkbox">
                                        <input type="radio" name="frequency" value="UnLock">
                                        <label>UnLock</label>
                                    </div>
                                </div>
                                <!--<div class="one wide field radio-field">
                                <div class="ui radio checkbox">
                                    <input type="radio" name="frequency">
                                    <label>UnLock</label>
                                </div>
                            </div>-->
                                <div class="two wide field buttons-field submit-field">
                                    <div class="field right float-end">
                                        <button class="ui blue button" id="submit" type="submit">SUBMIT</button>
                                        <!--<button class="ui grey button" id="clear" type="reset">Clear</button>-->
                                    </div>
                                </div>
                            </div>



                        </div>


                    </div>



                </div>

            </div>
        </div>
        <div class="ui bottom attached active tab segment" data-tab="search_report">
            <div class="ui column grid">
                <div class="column">
                    <div class="ui stacked aligned segment">
                        <div class="ui red ribbon label">Search</div>

                        <div class="ui medium form">
                            <div class="five fields">

                                <div class="three wide field">
                                    <label>Region</label>
                                    <select id="t_region" class="form-control input">
                                        <option value="">Select Region</option>
                                        <option value="ALL">ALL</option>
                                        <option value="APC">APC</option>
                                        <option value="APH">APH</option>
                                        <option value="APE">APE</option>
                                        <option value="GROUP">GROUP</option>
                                    </select>

                                </div>
                                <div class="three wide field">
                                    <label>Department</label>
                                    <select id="t_department" class="form-control input">
                                        <option value="">Select Department</option>

                                    </select>
                                </div>

                                <!--<div class="three wide field">
                                <label>Emp No</label>
                                <select id="t_employee" class="form-control input">
                                    <option value="">Select Emp No</option>

                                </select>

                            </div>-->
                                <div class="three wide field">
                                    <label>Category</label>
                                    <select id="t_Category" class="input">
                                        <option value="" selected>Select Category</option>
                                        <option value="ALL">ALL</option>
                                        <option value="项目Project">项目Project</option>
                                        <option value="运维-日常Maintenance-Daily">运维-日常Maintenance-Daily</option>
                                        <option value="运维-需求Maintenance-Req.">运维-需求Maintenance-Req.</option>
                                        <option value="行政管理Administration">行政管理Administration</option>
                                        <option value="培训学习Training/Study">培训学习 Training/Study</option>
                                        <option value="休假Leave">休假 Leave</option>
                                        <option value="空闲Idle">空闲 Idle</option>

                                    </select>
                                </div>
                                <!--<div class="three wide field" id="requirement1">
                                <label>Project Name</label>
                                <select id="t_project_name" class="form-control" autocomplete="off">
                                    <option value="" selected>Select Project</option>
                                </select>
                            </div>-->


                                <div class="three wide field">
                                    <label>From Date</label>
                                    <input type="text" id="t_fromDate" class="form-control" autocomplete="off">
                                </div>
                                <div class="three wide field">
                                    <label>To Date</label>
                                    <input type="text" id="t_toDate" class="form-control" autocomplete="off">
                                </div>
                                <div class="two wide field buttons-field submit-field">
                                    <div class="field right float-end">
                                        <button class="ui blue button" id="search" type="submit">SEARCH</button>
                                        <!--<button class="ui grey button" id="clear" type="reset">Clear</button>-->
                                    </div>
                                </div>
                            </div>
                            <!--<div class="five fields">


                            <div class="three wide field">
                                <label>From Date</label>
                                <input type="text" id="t_fromDate" class="form-control" autocomplete="off">
                            </div>
                            <div class="three wide field">
                                <label>To Date</label>
                                <input type="text" id="t_toDate" class="form-control" autocomplete="off">
                            </div>


                            <div class="two wide field buttons-field submit-field">
                                <div class="field right float-end">
                                    <button class="ui blue button" id="search" type="submit">SEARCH</button>-->
                            <!--<button class="ui grey button" id="clear" type="reset">Clear</button>-->
                            <!--</div>
                            </div>
                        </div>-->



                        </div>


                    </div>



                </div>

            </div>
            <br />
            <br />
            <div class="ui segment" id="rpt_grid">
                <table id="datatable" bgcolor="" class="display nowrap" style="width: 100%; border-radius: 10px">
                    <thead style="background-color: #E6E6FA ">
                        <tr>
                            <th scope="col">ID</th>
                            <th scope="col">DATE</th>
                            <th scope="col">REGION</th>
                            <th scope="col">DEPARTMENT</th>
                            <th scope="col">EMP NAME</th>
                            <th scope="col">EMP NO</th>
                            <th scope="col">LT(hrs)</th>
                            <th scope="col">CATEGORY</th>
                            <th scope="col">PROJECT NAME</th>
                            <th scope="col">REQUIREMENT NAME</th>
                            <th scope="col">CONTENT NAME</th>
                            <th scope="col">REMARK</th>
                            <th scope="col">CREATED DATE</th>
                            <th scope="col">CREATED TIME</th>
                            <th scope="col">CREATED BY</th>
                            <th scope="col">UPDATED DATE</th>
                            <th scope="col">UPDATED TIME</th>
                            <th scope="col">UPDATED BY</th>
                            <th scope="col">CHECK</th>
                            <th>STATUS</th>
                            <!--<th scope="col">REQUIREMENT NAME</th>
                        <th scope="col">CONTENT NAME</th>
                        <th scope="col">REMARK</th>-->

                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>




        </div>


        <div id="cover-spin"></div>

    </div>
   <!-- <script>

        $('.top.menu .item').tab();
     //   var apiURL = 'http://localhost:53943/api/apcnote/';

           var apiURL = 'http://10.3.0.70:9001/api/apcnote/';
         //  var apiURL = 'http://10.3.0.208:9001/api/apcnote/';



        var selectedRegion = '';

        $(document).ready(function () {


            $('#rpt_grid').hide();
            // Initialize datepicker for from date and to date fields
            $('#fromDate, #toDate,#t_fromDate,#t_toDate').datepicker({
                dateFormat: 'yy-mm-dd',
                changeMonth: true,
                changeYear: true,
            });
            Get_Projects();


            $('#region,#t_region').change(function () {

                selectedRegion = $(this).val();


                if (selectedRegion == '' || selectedRegion == null) {
                    alert('Please select Region');
                }
                else if (selectedRegion == 'ALL') {
                    $('#department,#t_department').empty();
                    $('#department,#t_department').dropdown('clear');

                    $('#department,#t_department').append($('<option>', {
                        value: '',
                        text: 'Select Department'
                    }));
                    $('#department,#t_department').append($('<option>', {
                        value: 'ALL',
                        text: 'ALL'
                    }));
                } else {


                    var region = {
                        Region: selectedRegion
                    };
                    $.post(apiURL + 'GetDepartmentsByRegion', region, function (response) {


                        // Clear existing options
                        $('#department,#t_department').empty();

                        // Add default option
                        $('#department,#t_department').append($('<option>', {
                            value: '',
                            text: 'Select Department'
                        }));
                        $('#department,#t_department').append($('<option>', {
                            value: 'ALL',
                            text: 'ALL'
                        }));
                        $.each(response, function (index, department) {

                            $('#department,#t_department').append($('<option>', {
                                value: department,
                                text: department
                            }));

                        });


                    }).fail(function (jqxhr, settings, ex) {
                        $(".dimmer").hide();
                        alert("error: " + ex);
                    });




                }


            });


            $('#department,#t_department').change(function () {

                var selectedDepartment = $(this).val();


                if (selectedDepartment == 'ALL') {
                    $('#employee,#t_employee').empty();

                    $('#employee,#t_employee').append($('<option>', {
                        value: 'ALL',
                        text: 'ALL'
                    }));
                }
                else {
                    $('#employee,#t_employee').empty();


                    $('#employee,#t_employee').append($('<option>', {
                        value: '',
                        text: 'Select Employee'
                    }));
                    var region = {
                        Region: selectedRegion,
                        Department: selectedDepartment
                    };
                    $.post(apiURL + 'GetEmpNosByRegion', region, function (response) {



                        if (response.length > 1) {
                            $('#employee,#t_employee').append($('<option>', {
                                value: 'ALL',
                                text: 'ALL'
                            }));
                        }
                        $.each(response, function (index, e_no) {
                            
                            $('#employee,#t_employee').append($('<option>', {
                                value: e_no,
                                text: e_no
                            }));
                        });



                    }).fail(function (jqxhr, settings, ex) {
                        $(".dimmer").hide();
                        alert("error: " + ex);
                    });

                }


            });


        });
        function Get_Projects() {

            $.ajax({
                url: apiURL + 'Get_Project',
                method: 'GET',
                data: { category: '' },
                success: function (data) {

                    var projects = JSON.parse(data);


                    projects.forEach(function (project) {
                        $('#project_name').append('<option value="' + project.PROJECT_NO + '">' + project.PROJECT_NAME + '</option>');
                        //$('#t_project_name').append('<option value="' + project.project_no + '">' + project.project_name + '</option>');

                    });
                },
                error: function () {
                    // Handle error if needed
                    console.error('Error fetching project list');
                }
            });
        }


        $('#submit').click(function () {

            if ($("#region").val() == "") {
                alert('Please Select Region');
                $("#region").focus();
            }
            else if ($("#department").val() == "") {
                alert('Please Select Department');
                $("#department").focus();
            } else if ($("#employee").val() == "") {
                alert('Please Select Employee Number');
                $("#employee").focus();
            }
            else if ($("#Category").val() == "") {
                alert('Please Select Category');
                $("#Category").focus();
            }
            else if ($("#fromDate").val() == "") {
                alert('Please Select From Date');
                $("#s_date").focus();
                return false;
            } else if
                ($("#toDate").val() == "") {
                alert('Please Select To Date');
                $("#e_date").focus();
                return false;
            } else if ($("#fromDate").val() > $("#toDate").val()) {
                alert('Start Date greater than To Date');
                $("#fromDate").focus();
            } else if (!$('input[name="frequency"]:checked').length) {
                alert('Please select Lock or Unlock');
                return false;
            }
            else {
                var input_details = {};
                input_details.Region = $('#region').val();
                input_details.Department = $('#department').val();
                input_details.EmployeeNumber = $('#employee').val();
                //  input_details.EmployeeNumber = $('#region').val();
                input_details.Category = $('#Category').val();
                input_details.ProjectName = $('#project_name').val();
                input_details.Start_date = $('#fromDate').val();
                input_details.To_date = $('#toDate').val();
                var lockValue = $('input[name="frequency"]:checked').val();
                var lockStatus = (lockValue === "Lock");
                input_details.Lock = lockStatus;
                // input_details.Region = $('#region').val();
                //input_details.Region = $('#region').val();
                $.post(apiURL + 'Lock_Manday_input', input_details, function (response) {


                    if (response == 'Success' && lockValue === "Lock") {
                        // alert("Succesfully DATA LOCKED");
                        toastr.success('Succesfully DATA LOCKED!', 'Success', { timeOut: 3000 });
                        Projects_data();

                    } else if (response == 'Success' && lockValue === "UnLock") {
                        // alert("Succesfully DATA UN-LOCKED");
                        toastr.success('Succesfully DATA UN-LOCKED!', 'Success', { timeOut: 3000 });
                        Projects_data();

                    }

                    else {

                        console.log('failed');

                    }
                }).fail(function (jqxhr, settings, ex) {
                    $(".dimmer").hide();
                    alert("Error: " + ex);
                });
            }



        });


        $('#search').click(function () {

            if ($("#t_region").val() == "") {
                alert('Please Select Region');
                $("#region").focus();
            }
            else if ($("#t_department").val() == "") {
                alert('Please Select Department');
                $("#department").focus();
            }
            else if ($("#t_fromDate").val() == "") {
                alert('Please Select From Date');
                $("#s_date").focus();
                return false;
            } else if
                ($("#t_toDate").val() == "") {
                alert('Please Select To Date');
                $("#e_date").focus();
                return false;
            } else if ($("#t_fromDate").val() > $("#t_toDate").val()) {
                alert('Start Date greater than To Date');
                $("#s_date").focus();
            }
            else {
                var User = {};

                User.Start_date = $("#t_fromDate").val();
                User.To_date = $("#t_toDate").val();
                User.Region = $('#t_region').val();
                User.Department = $('#t_department').val();


                User.Category = $('#t_Category').val();

                //$.ajax({
                //    type: "GET",
                //    contentType: "application/json", // Set Content-Type header to JSON
                //    dataType: "json",
                //    //contentType: "json",
                //   // data: JSON.stringify(User),
                //    data:User,
                //    url: apiURL + 'Daily_Manday_Report_LockStatus',
                //    success: function (data) {
                //        $('#rpt_grid').show();
                //        var datatableVariable = $('#datatable').DataTable({

                //            "destroy": "true",
                //            "dataSrc": "",
                //            data: data,
                //            columns: [
                //              /*  { data: 'ID', visible: true },*/
                //                {
                //                    data: null, title: 'S.No.', visible: true, render: function (data, type, row, meta) {
                //                        return meta.row + 1;
                //                    }
                //                },
                //                {
                //                    data: 'FillDate',
                //                    render: function (d) {
                //                        return moment(d).format("YYYY-MM-DD");
                //                    }
                //                },
                //                { data: 'Region' },
                //                { data: 'Department' },
                //                { data: 'EmployeeName' },
                //                { data: 'EmployeeNumber' },
                //                { data: 'LtH' },
                //                { data: 'Category' },
                //                { data: 'ProjectName' },
                //                { data: 'RequirementName' },
                //                { data: 'ContentName' },
                //                { data: 'Remark' },
                //                {
                //                    data: 'Lock',
                //                    render: function (data) {
                //                        if (data === true) {
                //                            return '<span style="color: red;">Lock</span>';
                //                        } else {
                //                            return '<span style="color: green;">Not Locked</span>';
                //                        }
                //                    }
                //                }


                //                //{ data: 'RequirementName', visible: false },
                //                //{
                //                //    data: 'ContentName',

                //                //    visible: false,
                //                //    width: "20px",
                //                //    render: function (data, type, row) {
                //                //        if (type === 'display') {
                //                //            var paragraphs = data.split('\n');
                //                //            return paragraphs.join('<br>');
                //                //        }
                //                //        return data;
                //                //    }
                //                //},
                //                //{ data: 'Remark', visible: false }

                //            ],
                //            //dom: 'Bfrtip',
                //            //buttons:
                //            //    [
                //            //        {
                //            //            extend: 'excelHtml5',
                //            //            title: 'Excel',
                //            //            text: 'Export to excel'

                //            //        }
                //            //    ]
                //        });

                //    }

                //});


                $.ajax({
                    type: "GET",
                    dataType: "json",
                    //contentType: "application/json",
                    data: User,
                    url: apiURL + 'Daily_Manday_Report_LockStatus',
                    success: function (data) {

                        $('#rpt_grid').show();
                        var datatableVariable = $('#datatable').DataTable({
                            "destroy": "true",
                            "dataSrc": "",
                            data: data,
                            scrollX: true,

                            columns: [
                                /* { data: 'ID', visible: true },*/
                                {
                                    data: null, title: 'S.No.', visible: true, render: function (data, type, row, meta) {
                                        return meta.row + 1;
                                    }
                                },
                                {
                                    data: 'FillDate',
                                    render: function (d) {
                                        return moment(d).format("YYYY-MM-DD");
                                    }
                                },
                                { data: 'Region' },
                                { data: 'Department' },
                                { data: 'EmployeeName' },
                                { data: 'EmployeeNumber' },
                                { data: 'LtH' },
                                { data: 'Category' },
                                { data: 'ProjectName' },
                                { data: 'RequirementName', visible: true },
                                {
                                    data: 'ContentName',

                                    visible: true,
                                    width: "20px",
                                    //render: function (data, type, row) {
                                    //    if (type === 'display') {
                                    //        var paragraphs = data.split('\n');
                                    //        return paragraphs.join('<br>');
                                    //    }
                                    //    return data;
                                    //}
                                },
                                { data: 'Remark', visible: true },
                                { data: 'CreatedDate', visible: true },
                                { data: 'CreatedTime', visible: true },
                                { data: 'CreatedBy', visible: true },
                                { data: 'UpdatedDate', visible: true },
                                { data: 'UpdatedTime', visible: true },
                                { data: 'UpdatedBy', visible: true },

                                {
                                    data: 'CheckType',
                                    title: 'Check',
                                    // title: '<input type="checkbox" id="selectAllCheckbox">',
                                    visible: true,
                                    render: function (data, type, row) {
                                        if (type === 'display') {
                                            if (row.CheckType == true) {
                                                return '<i class="fas fa-check" style="color: blue;"></i>';
                                            } else {
                                                return '<i class="fas fa-exclamation-circle" style="color: blue;"></i>';
                                            }
                                        } else if (type == 'myExport') {

                                            return row.CheckType ? 'Y' : 'N';
                                        } else {
                                            return data;
                                        }
                                    }
                                    //render: function (data, type, row) {
                                    //    if (row.CheckType == true) {
                                    //        return '<i class="fas fa-check" style="color: blue;"></i>';
                                    //    } else
                                    //        return '';
                                    //}
                                },
                                {
                                    data: 'Lock',
                                    render: function (data) {
                                        if (data === true) {
                                            /* return '<span style="color: red;">Lock</span>';*/
                                            return '<div class="lock">' + 'LOCKED' + '</div>';
                                        } else {
                                            /*return '<span style="color: green;">Not Locked</span>';*/
                                            return '<div class="unlock">' + 'NOT LOCKED' + '</div>';
                                        }
                                    }
                                }
                            ],
                            dom: 'Bfrtip',
                            buttons: [
                                {
                                    extend: 'excelHtml5',
                                    title: 'Excel for lock/unlock',
                                    text: 'Export to Excel',
                                    exportOptions: {
                                        orthogonal: "myExport"
                                    }
                                }
                            ],

                            drawCallback: function (settings) {
                                var api = this.api();
                                var rows = api.rows({ page: 'current' }).nodes();
                                var lastRegion = null;
                                var lastDepartment = null;

                                api.column(2, { page: 'current' }).data().each(function (group, i) {
                                    if (lastRegion !== group) {
                                        $(rows).eq(i).before('<tr class="group region-group"><td colspan="19">' + group + '</td></tr>');
                                        lastRegion = group;
                                    }

                                    var department = api.column(3, { page: 'current' }).data()[i];
                                    if (lastDepartment !== department) {
                                        $(rows).eq(i).before('<tr class="subgroup department-subgroup"><td colspan="19">' + department + '</td></tr>');
                                        lastDepartment = department;
                                    }
                                });

                                // Apply background colors to the region and department groups
                                $('.group.region-group').css('background-color', '#FADBD8'); // Change color as needed
                                $('.subgroup.department-subgroup').css('background-color', '#D4E6F1'); // Change color as needed
                            }



                        });
                    },

                    beforeSend: function () {
                        $('#cover-spin').show();
                    },
                    complete: function () {
                        $('#cover-spin').hide();

                    }

                });
            }
        });


    </script>-->
</body>

</html>
<script src="../Manday_JS/AccessPage.js"></script>